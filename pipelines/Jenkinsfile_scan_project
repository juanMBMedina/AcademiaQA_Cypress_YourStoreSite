pipeline {
    agent any

    environment {
        PROJECT_NAME = 'defaultProject'
        REPO_URL = 'git@github.com:user/repo.git'
        DEFAULT_BRANCH = 'main'
    }

    stages {
        stage('Clone or Update Repository') {
           load '../scan_code/Jenkinsfile_scan_repository'
           scanProject(PROJECT_NAME, REPO_URL, DEFAULT_BRANCH'main'){
        }    
    }

        post {
            success {
                echo "Scan completed successfully!"
            }
            failure {
                echo "Scan failed!"
            }
        }
    }
}